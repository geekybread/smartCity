{"ast":null,"code":"var _s = $RefreshSig$();\n// src/components/Map/hooks/useAlerts.js\nimport { useState, useEffect } from 'react';\nimport api from '../../../services/api';\nimport { useAuth } from '../../../context/AuthContext';\nexport default function useAlerts(city) {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const [alerts, setAlerts] = useState([]);\n  useEffect(() => {\n    if (!city) return setAlerts([]);\n    api.get(`/api/emergency-alerts/?city=${encodeURIComponent(city)}`).then(res => {\n      const now = new Date();\n      let list = res.data.filter(a => new Date(a.expiry_time) > now);\n      if (user) {\n        list = list.filter(a => !a.is_seen);\n        list.forEach(a => api.post(`/api/emergency-alerts/${a.id}/mark_seen/`).catch(() => {}));\n      }\n      setAlerts(list);\n    }).catch(() => setAlerts([]));\n  }, [city, user]);\n  return {\n    alerts\n  };\n}\n_s(useAlerts, \"l7rqlLjENGhB1YghBYP6Tka3Tj0=\", false, function () {\n  return [useAuth];\n});","map":{"version":3,"names":["useState","useEffect","api","useAuth","useAlerts","city","_s","user","alerts","setAlerts","get","encodeURIComponent","then","res","now","Date","list","data","filter","a","expiry_time","is_seen","forEach","post","id","catch"],"sources":["C:/MNNIT/SEM2/programmingLab2/Project/smartcity/smartCity/frontend/src/components/Map/hooks/useAlerts.js"],"sourcesContent":["// src/components/Map/hooks/useAlerts.js\r\nimport { useState, useEffect } from 'react';\r\nimport api from '../../../services/api';\r\nimport { useAuth } from '../../../context/AuthContext';\r\n\r\nexport default function useAlerts(city) {\r\n  const { user } = useAuth();\r\n  const [alerts, setAlerts] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (!city) return setAlerts([]);\r\n    api\r\n      .get(`/api/emergency-alerts/?city=${encodeURIComponent(city)}`)\r\n      .then(res => {\r\n        const now = new Date();\r\n        let list = res.data.filter(a => new Date(a.expiry_time) > now);\r\n        if (user) {\r\n          list = list.filter(a => !a.is_seen);\r\n          list.forEach(a =>\r\n            api.post(`/api/emergency-alerts/${a.id}/mark_seen/`).catch(() => {})\r\n          );\r\n        }\r\n        setAlerts(list);\r\n      })\r\n      .catch(() => setAlerts([]));\r\n  }, [city, user]);\r\n\r\n  return { alerts };\r\n}\r\n"],"mappings":";AAAA;AACA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,OAAOC,GAAG,MAAM,uBAAuB;AACvC,SAASC,OAAO,QAAQ,8BAA8B;AAEtD,eAAe,SAASC,SAASA,CAACC,IAAI,EAAE;EAAAC,EAAA;EACtC,MAAM;IAAEC;EAAK,CAAC,GAAGJ,OAAO,CAAC,CAAC;EAC1B,MAAM,CAACK,MAAM,EAAEC,SAAS,CAAC,GAAGT,QAAQ,CAAC,EAAE,CAAC;EAExCC,SAAS,CAAC,MAAM;IACd,IAAI,CAACI,IAAI,EAAE,OAAOI,SAAS,CAAC,EAAE,CAAC;IAC/BP,GAAG,CACAQ,GAAG,CAAC,+BAA+BC,kBAAkB,CAACN,IAAI,CAAC,EAAE,CAAC,CAC9DO,IAAI,CAACC,GAAG,IAAI;MACX,MAAMC,GAAG,GAAG,IAAIC,IAAI,CAAC,CAAC;MACtB,IAAIC,IAAI,GAAGH,GAAG,CAACI,IAAI,CAACC,MAAM,CAACC,CAAC,IAAI,IAAIJ,IAAI,CAACI,CAAC,CAACC,WAAW,CAAC,GAAGN,GAAG,CAAC;MAC9D,IAAIP,IAAI,EAAE;QACRS,IAAI,GAAGA,IAAI,CAACE,MAAM,CAACC,CAAC,IAAI,CAACA,CAAC,CAACE,OAAO,CAAC;QACnCL,IAAI,CAACM,OAAO,CAACH,CAAC,IACZjB,GAAG,CAACqB,IAAI,CAAC,yBAAyBJ,CAAC,CAACK,EAAE,aAAa,CAAC,CAACC,KAAK,CAAC,MAAM,CAAC,CAAC,CACrE,CAAC;MACH;MACAhB,SAAS,CAACO,IAAI,CAAC;IACjB,CAAC,CAAC,CACDS,KAAK,CAAC,MAAMhB,SAAS,CAAC,EAAE,CAAC,CAAC;EAC/B,CAAC,EAAE,CAACJ,IAAI,EAAEE,IAAI,CAAC,CAAC;EAEhB,OAAO;IAAEC;EAAO,CAAC;AACnB;AAACF,EAAA,CAvBuBF,SAAS;EAAA,QACdD,OAAO;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}