{"ast":null,"code":"import axios from 'axios';\nimport { getCountryCode } from '../utils/countryCodes';\n\n// Django backend configuration\nconst djangoAPI = axios.create({\n  baseURL: 'http://localhost:8000/api',\n  // Your Django server\n  timeout: 10000\n});\nconst requestCache = new Map();\n\n/**\r\n * Get city coordinates through Django backend\r\n */\nexport const getCityCoordinates = async (city, country = '') => {\n  const cacheKey = `coords_${city}_${country}`;\n\n  // Check cache first\n  if (requestCache.has(cacheKey)) {\n    return requestCache.get(cacheKey);\n  }\n  try {\n    const countryCode = country ? getCountryCode(country) : '';\n    if (country && !countryCode) {\n      throw new Error('INVALID_COUNTRY');\n    }\n\n    // Call Django backend endpoint\n    const {\n      data\n    } = await djangoAPI.get('/geocode/', {\n      params: {\n        city: city || undefined,\n        country: countryCode || undefined\n      }\n    });\n\n    // Validate response structure\n    if (!data || data.length === 0) {\n      throw new Error('LOCATION_NOT_FOUND');\n    }\n    const result = {\n      lat: data[0].lat,\n      lon: data[0].lon,\n      name: data[0].name,\n      country: data[0].country\n    };\n    requestCache.set(cacheKey, result);\n    return result;\n  } catch (error) {\n    console.error('Geocoding error:', error);\n    requestCache.set(cacheKey, {\n      error: error.message\n    });\n    throw error;\n  }\n};\n\n/**\r\n * Get country capital through Django backend\r\n */\nexport const getCountryCapital = async countryCode => {\n  try {\n    const {\n      data\n    } = await djangoAPI.get('/country-capital/', {\n      params: {\n        country_code: countryCode.toLowerCase()\n      }\n    });\n    return data.capital;\n  } catch (error) {\n    console.error('Country capital error:', error);\n    throw new Error('Failed to fetch country capital');\n  }\n};\n\n/**\r\n * Get weather data through Django backend\r\n */\nexport const getWeatherData = async (lat, lon) => {\n  const cacheKey = `weather_${lat}_${lon}`;\n  if (requestCache.has(cacheKey)) {\n    return requestCache.get(cacheKey);\n  }\n  try {\n    const {\n      data\n    } = await djangoAPI.get('/weather/', {\n      params: {\n        lat,\n        lon\n      }\n    });\n    requestCache.set(cacheKey, data);\n    return data;\n  } catch (error) {\n    console.error('Weather data error:', error);\n    throw new Error('Failed to fetch weather data');\n  }\n};\n\n/**\r\n * Get air quality data through Django backend\r\n */\nexport const getAirQualityData = async (lat, lon) => {\n  const cacheKey = `air_${lat}_${lon}`;\n  if (requestCache.has(cacheKey)) {\n    return requestCache.get(cacheKey);\n  }\n  try {\n    const {\n      data\n    } = await djangoAPI.get('/air-pollution/', {\n      params: {\n        lat,\n        lon\n      }\n    });\n    requestCache.set(cacheKey, data);\n    return data;\n  } catch (error) {\n    console.error('Air quality error:', error);\n    throw new Error('Failed to fetch air quality data');\n  }\n};","map":{"version":3,"names":["axios","getCountryCode","djangoAPI","create","baseURL","timeout","requestCache","Map","getCityCoordinates","city","country","cacheKey","has","get","countryCode","Error","data","params","undefined","length","result","lat","lon","name","set","error","console","message","getCountryCapital","country_code","toLowerCase","capital","getWeatherData","getAirQualityData"],"sources":["C:/MNNIT/SEM2/programmingLab2/Project/smartcity/smartCity/frontend/src/services/weather.js"],"sourcesContent":["import axios from 'axios';\r\nimport { getCountryCode } from '../utils/countryCodes';\r\n\r\n// Django backend configuration\r\nconst djangoAPI = axios.create({\r\n  baseURL: 'http://localhost:8000/api', // Your Django server\r\n  timeout: 10000\r\n});\r\n\r\nconst requestCache = new Map();\r\n\r\n/**\r\n * Get city coordinates through Django backend\r\n */\r\nexport const getCityCoordinates = async (city, country = '') => {\r\n  const cacheKey = `coords_${city}_${country}`;\r\n  \r\n  // Check cache first\r\n  if (requestCache.has(cacheKey)) {\r\n    return requestCache.get(cacheKey);\r\n  }\r\n\r\n  try {\r\n    const countryCode = country ? getCountryCode(country) : '';\r\n    \r\n    if (country && !countryCode) {\r\n      throw new Error('INVALID_COUNTRY');\r\n    }\r\n\r\n    // Call Django backend endpoint\r\n    const { data } = await djangoAPI.get('/geocode/', {\r\n      params: {\r\n        city: city || undefined,\r\n        country: countryCode || undefined\r\n      }\r\n    });\r\n\r\n    // Validate response structure\r\n    if (!data || data.length === 0) {\r\n      throw new Error('LOCATION_NOT_FOUND');\r\n    }\r\n\r\n    const result = { \r\n      lat: data[0].lat, \r\n      lon: data[0].lon,\r\n      name: data[0].name,\r\n      country: data[0].country\r\n    };\r\n    \r\n    requestCache.set(cacheKey, result);\r\n    return result;\r\n\r\n  } catch (error) {\r\n    console.error('Geocoding error:', error);\r\n    requestCache.set(cacheKey, { error: error.message });\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get country capital through Django backend\r\n */\r\nexport const getCountryCapital = async (countryCode) => {\r\n  try {\r\n    const { data } = await djangoAPI.get('/country-capital/', {\r\n      params: { country_code: countryCode.toLowerCase() }\r\n    });\r\n    return data.capital;\r\n  } catch (error) {\r\n    console.error('Country capital error:', error);\r\n    throw new Error('Failed to fetch country capital');\r\n  }\r\n};\r\n\r\n/**\r\n * Get weather data through Django backend\r\n */\r\nexport const getWeatherData = async (lat, lon) => {\r\n  const cacheKey = `weather_${lat}_${lon}`;\r\n  \r\n  if (requestCache.has(cacheKey)) {\r\n    return requestCache.get(cacheKey);\r\n  }\r\n\r\n  try {\r\n    const { data } = await djangoAPI.get('/weather/', {\r\n      params: { lat, lon }\r\n    });\r\n    \r\n    requestCache.set(cacheKey, data);\r\n    return data;\r\n    \r\n  } catch (error) {\r\n    console.error('Weather data error:', error);\r\n    throw new Error('Failed to fetch weather data');\r\n  }\r\n};\r\n\r\n/**\r\n * Get air quality data through Django backend\r\n */\r\nexport const getAirQualityData = async (lat, lon) => {\r\n  const cacheKey = `air_${lat}_${lon}`;\r\n  \r\n  if (requestCache.has(cacheKey)) {\r\n    return requestCache.get(cacheKey);\r\n  }\r\n\r\n  try {\r\n    const { data } = await djangoAPI.get('/air-pollution/', {\r\n      params: { lat, lon }\r\n    });\r\n    \r\n    requestCache.set(cacheKey, data);\r\n    return data;\r\n    \r\n  } catch (error) {\r\n    console.error('Air quality error:', error);\r\n    throw new Error('Failed to fetch air quality data');\r\n  }\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}