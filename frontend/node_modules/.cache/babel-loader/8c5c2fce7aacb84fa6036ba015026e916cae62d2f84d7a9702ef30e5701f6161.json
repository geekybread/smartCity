{"ast":null,"code":"var _jsxFileName = \"C:\\\\MNNIT\\\\SEM2\\\\programmingLab2\\\\Project\\\\smartcity\\\\smartCity\\\\frontend\\\\src\\\\components\\\\Auth\\\\GoogleLogin.js\",\n  _s = $RefreshSig$();\n// src/components/Auth/GoogleLogin.js\n\nimport { GoogleOAuthProvider, GoogleLogin } from '@react-oauth/google';\nimport axios from 'axios';\nimport { useAuth } from '../../context/AuthContext';\nimport { toast } from 'react-toastify';\nimport { useState } from 'react';\nimport './GoogleLogin.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst GoogleAuth = () => {\n  _s();\n  var _user$first_name, _user$first_name$;\n  const {\n    user,\n    login,\n    logout\n  } = useAuth();\n  const [menuOpen, setMenuOpen] = useState(false);\n  const handleSuccess = async credentialResponse => {\n    const id_token = credentialResponse.credential;\n    try {\n      var _data$user;\n      const {\n        data\n      } = await axios.post(`${process.env.REACT_APP_API_BASE_URL}/api/auth/google/`, {\n        id_token\n      }, {\n        withCredentials: true\n      });\n      login(data.key, {\n        ...data.user,\n        first_name: data.user.first_name || ''\n      });\n      toast.success(`âœ… Welcome, ${((_data$user = data.user) === null || _data$user === void 0 ? void 0 : _data$user.first_name) || 'User'}!`);\n    } catch (err) {\n      var _err$response, _err$response2, _err$response2$data;\n      console.error('âŒ Backend error:', ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data) || err.message);\n      toast.error(`âŒ Login failed: ${((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.error) || err.message}`);\n    }\n  };\n  const getInitials = nameOrEmail => {\n    if (!nameOrEmail) return '?';\n    const name = nameOrEmail.split('@')[0];\n    return name[0].toUpperCase();\n  };\n  const toggleMenu = () => setMenuOpen(prev => !prev);\n  return /*#__PURE__*/_jsxDEV(GoogleOAuthProvider, {\n    clientId: process.env.REACT_APP_GOOGLE_CLIENT_ID,\n    children: !user ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"google-auth-wrapper\",\n      children: /*#__PURE__*/_jsxDEV(GoogleLogin, {\n        onSuccess: handleSuccess,\n        onError: () => toast.error('âŒ Google Login Failed'),\n        ux_mode: \"popup\",\n        theme: \"outline\",\n        size: \"large\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"user-menu\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"avatar-circle\",\n        onClick: toggleMenu,\n        children: ((_user$first_name = user.first_name) === null || _user$first_name === void 0 ? void 0 : (_user$first_name$ = _user$first_name[0]) === null || _user$first_name$ === void 0 ? void 0 : _user$first_name$.toUpperCase()) || getInitials(user.email)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 11\n      }, this), menuOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"dropdown-menu\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"user-name\",\n          children: [\"\\uD83D\\uDC64 \", user.first_name || user.email.split('@')[0]]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"dropdown-action\",\n          onClick: () => {\n            setMenuOpen(false);\n            window.location.href = \"/profile\";\n          },\n          children: \"Profile\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"logout-btn\",\n          onClick: () => {\n            logout();\n            toast.info('ðŸ”“ Logged out');\n            setMenuOpen(false);\n          },\n          children: \"Logout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 5\n  }, this);\n};\n_s(GoogleAuth, \"N3wA8HhMJQI8JCptS3jQ9t8ZeLY=\", false, function () {\n  return [useAuth];\n});\n_c = GoogleAuth;\nexport default GoogleAuth;\nvar _c;\n$RefreshReg$(_c, \"GoogleAuth\");","map":{"version":3,"names":["GoogleOAuthProvider","GoogleLogin","axios","useAuth","toast","useState","jsxDEV","_jsxDEV","GoogleAuth","_s","_user$first_name","_user$first_name$","user","login","logout","menuOpen","setMenuOpen","handleSuccess","credentialResponse","id_token","credential","_data$user","data","post","process","env","REACT_APP_API_BASE_URL","withCredentials","key","first_name","success","err","_err$response","_err$response2","_err$response2$data","console","error","response","message","getInitials","nameOrEmail","name","split","toUpperCase","toggleMenu","prev","clientId","REACT_APP_GOOGLE_CLIENT_ID","children","className","onSuccess","onError","ux_mode","theme","size","fileName","_jsxFileName","lineNumber","columnNumber","onClick","email","window","location","href","info","_c","$RefreshReg$"],"sources":["C:/MNNIT/SEM2/programmingLab2/Project/smartcity/smartCity/frontend/src/components/Auth/GoogleLogin.js"],"sourcesContent":["// src/components/Auth/GoogleLogin.js\r\n\r\nimport { GoogleOAuthProvider, GoogleLogin } from '@react-oauth/google';\r\nimport axios from 'axios';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport { toast } from 'react-toastify';\r\nimport { useState } from 'react';\r\nimport './GoogleLogin.css';\r\n\r\nconst GoogleAuth = () => {\r\n  const { user, login, logout } = useAuth();\r\n  const [menuOpen, setMenuOpen] = useState(false);\r\n\r\n  const handleSuccess = async credentialResponse => {\r\n    const id_token = credentialResponse.credential;\r\n\r\n    try {\r\n      const { data } = await axios.post(\r\n        `${process.env.REACT_APP_API_BASE_URL}/api/auth/google/`,\r\n        { id_token },\r\n        { withCredentials: true }\r\n      );\r\n      login(data.key, {\r\n        ...data.user,\r\n        first_name: data.user.first_name || '',\r\n      });\r\n      \r\n      toast.success(`âœ… Welcome, ${data.user?.first_name || 'User'}!`);\r\n    } catch (err) {\r\n      console.error('âŒ Backend error:', err.response?.data || err.message);\r\n      toast.error(`âŒ Login failed: ${err.response?.data?.error || err.message}`);\r\n    }\r\n  };\r\n\r\n  const getInitials = (nameOrEmail) => {\r\n    if (!nameOrEmail) return '?';\r\n    const name = nameOrEmail.split('@')[0];\r\n    return name[0].toUpperCase();\r\n  };\r\n\r\n  const toggleMenu = () => setMenuOpen(prev => !prev);\r\n\r\n  return (\r\n    <GoogleOAuthProvider clientId={process.env.REACT_APP_GOOGLE_CLIENT_ID}>\r\n      {!user ? (\r\n        <div className=\"google-auth-wrapper\">\r\n          <GoogleLogin\r\n            onSuccess={handleSuccess}\r\n            onError={() => toast.error('âŒ Google Login Failed')}\r\n            ux_mode=\"popup\"\r\n            theme=\"outline\"\r\n            size=\"large\"\r\n          />\r\n        </div>\r\n      ) : (\r\n        <div className=\"user-menu\">\r\n          <div className=\"avatar-circle\" onClick={toggleMenu}>\r\n            {user.first_name?.[0]?.toUpperCase() || getInitials(user.email)}\r\n          </div>\r\n          {menuOpen && (\r\n            <div className=\"dropdown-menu\">\r\n              <div className=\"user-name\">\r\n              ðŸ‘¤ {user.first_name || user.email.split('@')[0]}\r\n              </div>\r\n            \r\n              <button\r\n                className=\"dropdown-action\"\r\n                onClick={() => {\r\n                  setMenuOpen(false);\r\n                  window.location.href = \"/profile\";\r\n                }}\r\n              >\r\n                Profile\r\n              </button>\r\n\r\n\r\n            \r\n              <button\r\n                className=\"logout-btn\"\r\n                onClick={() => {\r\n                  logout();\r\n                  toast.info('ðŸ”“ Logged out');\r\n                  setMenuOpen(false);\r\n                }}\r\n              >\r\n                Logout\r\n              </button>\r\n            </div>\r\n          \r\n          )}\r\n        </div>\r\n      )}\r\n    </GoogleOAuthProvider>\r\n  );\r\n};\r\n\r\nexport default GoogleAuth;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}