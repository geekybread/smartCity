{"ast":null,"code":"import axios from 'axios';\nconst API_KEY = 'f9293dbeda02be4bda1ce865b2706cb4';\nconst BASE_URL = 'https://api.openweathermap.org/data/2.5';\n\n// Fetch weather data\nexport const getWeatherData = async (lat, lon) => {\n  const response = await axios.get(`${BASE_URL}/weather?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric`);\n  return response.data;\n};\n\n// Fetch city coordinates\nexport const getCityCoordinates = async (city, country = '') => {\n  try {\n    // Try exact match first (city + country)\n    if (country) {\n      const response = await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${encodeURIComponent(city)},${encodeURIComponent(country)}&limit=5&appid=${API_KEY}`);\n      const data = await response.json();\n\n      // Find best match (prioritize exact matches)\n      const exactMatch = data.find(item => item.name.toLowerCase() === city.toLowerCase() && item.country.toLowerCase() === country.toLowerCase());\n      if (exactMatch) {\n        return {\n          lat: exactMatch.lat,\n          lon: exactMatch.lon,\n          foundPrecise: true,\n          actualCountry: exactMatch.country\n        };\n      }\n\n      // If no exact match but API returned something\n      if (data.length > 0) {\n        return {\n          lat: data[0].lat,\n          lon: data[0].lon,\n          foundPrecise: false,\n          actualCountry: data[0].country\n        };\n      }\n    }\n\n    // Fallback to global city search\n    const globalResponse = await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${encodeURIComponent(city)}&limit=5&appid=${API_KEY}`);\n    const globalData = await globalResponse.json();\n    if (globalData.length === 0) {\n      throw new Error('LOCATION_NOT_FOUND');\n    }\n    return {\n      lat: globalData[0].lat,\n      lon: globalData[0].lon,\n      foundPrecise: false,\n      actualCountry: globalData[0].country\n    };\n  } catch (error) {\n    console.error('Geocoding error:', error);\n    throw error;\n  }\n};","map":{"version":3,"names":["axios","API_KEY","BASE_URL","getWeatherData","lat","lon","response","get","data","getCityCoordinates","city","country","fetch","encodeURIComponent","json","exactMatch","find","item","name","toLowerCase","foundPrecise","actualCountry","length","globalResponse","globalData","Error","error","console"],"sources":["C:/MNNIT/SEM2/programmingLab2/Project/smartcity/smartCity/frontend/src/services/weather.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API_KEY = 'f9293dbeda02be4bda1ce865b2706cb4';\r\nconst BASE_URL = 'https://api.openweathermap.org/data/2.5';\r\n\r\n// Fetch weather data\r\nexport const getWeatherData = async (lat, lon) => {\r\n  const response = await axios.get(`${BASE_URL}/weather?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric`);\r\n  return response.data;\r\n};\r\n\r\n// Fetch city coordinates\r\nexport const getCityCoordinates = async (city, country = '') => {\r\n  try {\r\n    // Try exact match first (city + country)\r\n    if (country) {\r\n      const response = await fetch(\r\n        `https://api.openweathermap.org/geo/1.0/direct?q=${encodeURIComponent(city)},${encodeURIComponent(country)}&limit=5&appid=${API_KEY}`\r\n      );\r\n      \r\n      const data = await response.json();\r\n      \r\n      // Find best match (prioritize exact matches)\r\n      const exactMatch = data.find(item => \r\n        item.name.toLowerCase() === city.toLowerCase() && \r\n        item.country.toLowerCase() === country.toLowerCase()\r\n      );\r\n      \r\n      if (exactMatch) {\r\n        return {\r\n          lat: exactMatch.lat,\r\n          lon: exactMatch.lon,\r\n          foundPrecise: true,\r\n          actualCountry: exactMatch.country\r\n        };\r\n      }\r\n      \r\n      // If no exact match but API returned something\r\n      if (data.length > 0) {\r\n        return {\r\n          lat: data[0].lat,\r\n          lon: data[0].lon,\r\n          foundPrecise: false,\r\n          actualCountry: data[0].country\r\n        };\r\n      }\r\n    }\r\n\r\n    // Fallback to global city search\r\n    const globalResponse = await fetch(\r\n      `https://api.openweathermap.org/geo/1.0/direct?q=${encodeURIComponent(city)}&limit=5&appid=${API_KEY}`\r\n    );\r\n    \r\n    const globalData = await globalResponse.json();\r\n    \r\n    if (globalData.length === 0) {\r\n      throw new Error('LOCATION_NOT_FOUND');\r\n    }\r\n    \r\n    return {\r\n      lat: globalData[0].lat,\r\n      lon: globalData[0].lon,\r\n      foundPrecise: false,\r\n      actualCountry: globalData[0].country\r\n    };\r\n  } catch (error) {\r\n    console.error('Geocoding error:', error);\r\n    throw error;\r\n  }\r\n};"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,OAAO,GAAG,kCAAkC;AAClD,MAAMC,QAAQ,GAAG,yCAAyC;;AAE1D;AACA,OAAO,MAAMC,cAAc,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,KAAK;EAChD,MAAMC,QAAQ,GAAG,MAAMN,KAAK,CAACO,GAAG,CAAC,GAAGL,QAAQ,gBAAgBE,GAAG,QAAQC,GAAG,UAAUJ,OAAO,eAAe,CAAC;EAC3G,OAAOK,QAAQ,CAACE,IAAI;AACtB,CAAC;;AAED;AACA,OAAO,MAAMC,kBAAkB,GAAG,MAAAA,CAAOC,IAAI,EAAEC,OAAO,GAAG,EAAE,KAAK;EAC9D,IAAI;IACF;IACA,IAAIA,OAAO,EAAE;MACX,MAAML,QAAQ,GAAG,MAAMM,KAAK,CAC1B,mDAAmDC,kBAAkB,CAACH,IAAI,CAAC,IAAIG,kBAAkB,CAACF,OAAO,CAAC,kBAAkBV,OAAO,EACrI,CAAC;MAED,MAAMO,IAAI,GAAG,MAAMF,QAAQ,CAACQ,IAAI,CAAC,CAAC;;MAElC;MACA,MAAMC,UAAU,GAAGP,IAAI,CAACQ,IAAI,CAACC,IAAI,IAC/BA,IAAI,CAACC,IAAI,CAACC,WAAW,CAAC,CAAC,KAAKT,IAAI,CAACS,WAAW,CAAC,CAAC,IAC9CF,IAAI,CAACN,OAAO,CAACQ,WAAW,CAAC,CAAC,KAAKR,OAAO,CAACQ,WAAW,CAAC,CACrD,CAAC;MAED,IAAIJ,UAAU,EAAE;QACd,OAAO;UACLX,GAAG,EAAEW,UAAU,CAACX,GAAG;UACnBC,GAAG,EAAEU,UAAU,CAACV,GAAG;UACnBe,YAAY,EAAE,IAAI;UAClBC,aAAa,EAAEN,UAAU,CAACJ;QAC5B,CAAC;MACH;;MAEA;MACA,IAAIH,IAAI,CAACc,MAAM,GAAG,CAAC,EAAE;QACnB,OAAO;UACLlB,GAAG,EAAEI,IAAI,CAAC,CAAC,CAAC,CAACJ,GAAG;UAChBC,GAAG,EAAEG,IAAI,CAAC,CAAC,CAAC,CAACH,GAAG;UAChBe,YAAY,EAAE,KAAK;UACnBC,aAAa,EAAEb,IAAI,CAAC,CAAC,CAAC,CAACG;QACzB,CAAC;MACH;IACF;;IAEA;IACA,MAAMY,cAAc,GAAG,MAAMX,KAAK,CAChC,mDAAmDC,kBAAkB,CAACH,IAAI,CAAC,kBAAkBT,OAAO,EACtG,CAAC;IAED,MAAMuB,UAAU,GAAG,MAAMD,cAAc,CAACT,IAAI,CAAC,CAAC;IAE9C,IAAIU,UAAU,CAACF,MAAM,KAAK,CAAC,EAAE;MAC3B,MAAM,IAAIG,KAAK,CAAC,oBAAoB,CAAC;IACvC;IAEA,OAAO;MACLrB,GAAG,EAAEoB,UAAU,CAAC,CAAC,CAAC,CAACpB,GAAG;MACtBC,GAAG,EAAEmB,UAAU,CAAC,CAAC,CAAC,CAACnB,GAAG;MACtBe,YAAY,EAAE,KAAK;MACnBC,aAAa,EAAEG,UAAU,CAAC,CAAC,CAAC,CAACb;IAC/B,CAAC;EACH,CAAC,CAAC,OAAOe,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,kBAAkB,EAAEA,KAAK,CAAC;IACxC,MAAMA,KAAK;EACb;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}