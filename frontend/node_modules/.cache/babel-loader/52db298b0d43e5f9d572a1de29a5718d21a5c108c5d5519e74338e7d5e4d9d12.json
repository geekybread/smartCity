{"ast":null,"code":"var _jsxFileName = \"C:\\\\MNNIT\\\\SEM2\\\\programmingLab2\\\\Project\\\\smartcity\\\\smartCity\\\\frontend\\\\src\\\\components\\\\Auth\\\\PhoneVerificationModal.js\",\n  _s = $RefreshSig$();\n// src/components/Auth/PhoneVerificationModal.js\nimport React, { useState } from 'react';\nimport './PhoneVerificationModal.css'; // optional styling\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function PhoneVerificationModal({\n  isOpen,\n  onClose,\n  onVerified\n}) {\n  _s();\n  const [step, setStep] = useState('phone'); // 'phone' | 'otp'\n  const [phone, setPhone] = useState('');\n  const [otp, setOtp] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  if (!isOpen) return null;\n  const handleStartVerification = async () => {\n    setError(null);\n    setLoading(true);\n    try {\n      await axios.post('/api/accounts/verify/start/', {\n        phone\n      });\n      setStep('otp');\n    } catch (err) {\n      var _err$response, _err$response$data;\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || 'Failed to start verification');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleVerifyOtp = async () => {\n    setError(null);\n    setLoading(true);\n    try {\n      const res = await axios.post('/api/accounts/verify/check/', {\n        phone,\n        code: otp\n      });\n      if (res.data.verified) {\n        onVerified();\n        onClose();\n      } else {\n        setError('Invalid OTP');\n      }\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      setError(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.error) || 'Failed to verify OTP');\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"phone-verification-backdrop\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"phone-verification-modal\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\uD83D\\uDCF1 Verify Your Phone\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 9\n      }, this), step === 'phone' ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Enter your phone number (with country code):\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"tel\",\n          value: phone,\n          onChange: e => setPhone(e.target.value),\n          placeholder: \"+919876543210\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleStartVerification,\n          disabled: loading,\n          children: loading ? 'Sending...' : 'Send OTP'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: [\"Enter the OTP sent to \", phone, \":\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: otp,\n          onChange: e => setOtp(e.target.value),\n          placeholder: \"123456\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleVerifyOtp,\n          disabled: loading,\n          children: loading ? 'Verifying...' : 'Verify'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 19\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 47,\n    columnNumber: 5\n  }, this);\n}\n_s(PhoneVerificationModal, \"GGmaTRZHd+ZEidZN9BnsACKiEbQ=\");\n_c = PhoneVerificationModal;\nvar _c;\n$RefreshReg$(_c, \"PhoneVerificationModal\");","map":{"version":3,"names":["React","useState","axios","jsxDEV","_jsxDEV","Fragment","_Fragment","PhoneVerificationModal","isOpen","onClose","onVerified","_s","step","setStep","phone","setPhone","otp","setOtp","loading","setLoading","error","setError","handleStartVerification","post","err","_err$response","_err$response$data","response","data","handleVerifyOtp","res","code","verified","_err$response2","_err$response2$data","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","value","onChange","e","target","placeholder","onClick","disabled","_c","$RefreshReg$"],"sources":["C:/MNNIT/SEM2/programmingLab2/Project/smartcity/smartCity/frontend/src/components/Auth/PhoneVerificationModal.js"],"sourcesContent":["// src/components/Auth/PhoneVerificationModal.js\r\nimport React, { useState } from 'react';\r\nimport './PhoneVerificationModal.css'; // optional styling\r\nimport axios from 'axios';\r\n\r\nexport default function PhoneVerificationModal({ isOpen, onClose, onVerified }) {\r\n  const [step, setStep] = useState('phone'); // 'phone' | 'otp'\r\n  const [phone, setPhone] = useState('');\r\n  const [otp, setOtp] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  const handleStartVerification = async () => {\r\n    setError(null);\r\n    setLoading(true);\r\n    try {\r\n      await axios.post('/api/accounts/verify/start/', { phone });\r\n      setStep('otp');\r\n    } catch (err) {\r\n      setError(err.response?.data?.error || 'Failed to start verification');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleVerifyOtp = async () => {\r\n    setError(null);\r\n    setLoading(true);\r\n    try {\r\n      const res = await axios.post('/api/accounts/verify/check/', { phone, code: otp });\r\n      if (res.data.verified) {\r\n        onVerified();\r\n        onClose();\r\n      } else {\r\n        setError('Invalid OTP');\r\n      }\r\n    } catch (err) {\r\n      setError(err.response?.data?.error || 'Failed to verify OTP');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"phone-verification-backdrop\">\r\n      <div className=\"phone-verification-modal\">\r\n        <h2>ðŸ“± Verify Your Phone</h2>\r\n\r\n        {step === 'phone' ? (\r\n          <>\r\n            <label>Enter your phone number (with country code):</label>\r\n            <input\r\n              type=\"tel\"\r\n              value={phone}\r\n              onChange={e => setPhone(e.target.value)}\r\n              placeholder=\"+919876543210\"\r\n            />\r\n            <button onClick={handleStartVerification} disabled={loading}>\r\n              {loading ? 'Sending...' : 'Send OTP'}\r\n            </button>\r\n          </>\r\n        ) : (\r\n          <>\r\n            <label>Enter the OTP sent to {phone}:</label>\r\n            <input\r\n              type=\"text\"\r\n              value={otp}\r\n              onChange={e => setOtp(e.target.value)}\r\n              placeholder=\"123456\"\r\n            />\r\n            <button onClick={handleVerifyOtp} disabled={loading}>\r\n              {loading ? 'Verifying...' : 'Verify'}\r\n            </button>\r\n          </>\r\n        )}\r\n\r\n        {error && <div className=\"error\">{error}</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}